/*! iptools-jquery-modal - v0.0.4 - 2015-06-29
* https://github.com/interactive-pioneers/iptools-jquery-modal
* Copyright Â© 2015 Interactive Pioneers GmbH; Licensed GPL */
!function(a,b,c){"use strict";function d(b,c){this.element=a(b),this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.contentLink=this.element.data(g.modalContent),this.$content=null,this.loaded=!1,this.$modal=a("<div/>",{"class":this.settings.modalClass,width:this.settings.width,height:this.settings.height}),this.effect=this.element.data(g.effect),this.effect&&this.$modal.addClass(this.settings.modalClass+h.effectModifierPrefix+this.effect),a("body").append(this.$modal),this.addEventListeners()}var e="iptModal",f={width:"auto",height:"auto",zIndex:102,closeOnESC:!0,closeOnClickOutside:!0,closeButton:!0,modalClass:"modal",showSpinner:!0,spinnerClass:"modal__spinner--default",spinnerHTML:""},g={modalContent:"modal-content",effect:"modal-effect"},h={activeModifier:"--active",effectModifierPrefix:"--effect-"};d.prototype={open:function(b){var c=b.data;if(c.loaded)c.show(),c.bindTemporaryEvents();else if(/^#/.test(c.contentLink)){var d=a(c.contentLink);1===d.length&&(c.$modal.html(d.html()),c.addCloseButton(),c.loaded=!0,c.show(),c.bindTemporaryEvents())}else c.showSpinner(),a.get(c.contentLink).done(function(a){c.$modal.html(a),c.addCloseButton(),c.loaded=!0,c.hideSpinner(),c.show(),c.bindTemporaryEvents()}).fail(function(){c.hideSpinner()});b.preventDefault()},close:function(a){var b=a.data;b.hide(),b.unbindTemporaryEvents()},show:function(){this.center(),this.$modal.addClass(this.settings.modalClass+h.activeModifier)},hide:function(){this.$modal.removeClass(this.settings.modalClass+h.activeModifier)},addCloseButton:function(){this.settings.closeButton&&(this.closeButton=a("<div/>").addClass(this.settings.modalClass+"__button-close").appendTo(this.$modal))},showSpinner:function(){this.settings.showSpinner&&(this.spinner||(this.spinner=a("<div/>").addClass(this.settings.modalClass+"__spinner").addClass(this.settings.spinnerClass).append(this.settings.spinnerHTML)),a("body").append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&(this.spinner.hide(),this.spinner.remove())},center:function(){this.$modal.css({position:"fixed",top:"50%",left:"50%",marginTop:.5*-this.$modal.outerHeight(),marginLeft:.5*-this.$modal.outerWidth(),zIndex:this.settings.zIndex})},bindTemporaryEvents:function(){this.closeButton&&this.closeButton.on("click."+this._name,null,this,this.close),this.settings.closeOnESC&&a(c).on("keydown."+this._name,null,this,this.handleKeyDown),this.settings.closeOnClickOutside&&a(c).on("mouseup."+this._name,null,this,this.handleBodyClick),a(b).on("resize."+this._name,null,this,this.handleResize)},unbindTemporaryEvents:function(){a(c).off("keydown."+this._name+" mouseup."+this._name),a(b).off("resize."+this._name)},handleKeyDown:function(a){var b=a.data;27===a.which&&b.close(a)},handleBodyClick:function(a){var b=a.data;b.$modal.is(a.target)||0!==b.$modal.has(a.target).length||b.close(a)},handleResize:function(a){var b=a.data;"undefined"!=typeof b.resizeTimeout&&clearTimeout(b.resizeTimeout),b.resizeTimeout=setTimeout(function(){b.center()},250)},addEventListeners:function(){this.element.on("click."+this._name,null,this,this.open)},destroy:function(){this.unbindTemporaryEvents(),this.element.off("click."+this._name),this.element.removeData("plugin_"+e)}},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);