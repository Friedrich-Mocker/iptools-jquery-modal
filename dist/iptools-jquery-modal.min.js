/*! iptools-jquery-modal - v0.0.2 - 2015-06-08
* https://github.com/interactive-pioneers/iptools-jquery-modal
* Copyright Â© 2015 Interactive Pioneers GmbH; Licensed GPL */
!function(a,b){"use strict";function c(b,c){this.element=a(b),this.settings=a.extend({},e,c),this._defaults=e,this._name=d,this.contentLink=this.element.data(f.modalContent),this.$content=null,this.loaded=!1,this.$modal=a("<div/>",{"class":this.settings.modalClass,width:this.settings.width,height:this.settings.height}),this.effect=this.element.data(f.effect),this.effect&&this.$modal.addClass(this.settings.modalClass+g.effectModifierPrefix+this.effect),a("body").append(this.$modal),this.addEventListeners()}var d="iptModal",e={width:"auto",height:"auto",zIndex:102,closeOnESC:!0,closeOnClickOutside:!0,closeButton:!0,showSpinner:!0,spinnerHTML:"",modalClass:"modal"},f={modalContent:"modal-content",effect:"modal-effect"},g={activeModifier:"--active",effectModifierPrefix:"--effect-"};c.prototype={open:function(b){var c=b.data;if(c.loaded)c.show(),c.bindCloseEvents();else if(/^#/.test(c.contentLink)){var d=a(c.contentLink);1===d.length&&(c.$modal.html(d.html()),c.addCloseButton(),c.loaded=!0,c.show(),c.bindCloseEvents())}else c.showSpinner(),a.get(c.contentLink).done(function(a){c.$modal.html(a),c.addCloseButton(),c.loaded=!0,c.hideSpinner(),c.show(),c.bindCloseEvents()}).fail(function(){c.hideSpinner()})},close:function(a){var b=a.data;b.hide(),b.unbindCloseEvents()},show:function(){this.center(),this.$modal.addClass(this.settings.modalClass+g.activeModifier)},hide:function(){this.$modal.removeClass(this.settings.modalClass+g.activeModifier)},addCloseButton:function(){this.settings.closeButton&&(this.closeButton=a('<div class="'+this.settings.modalClass+'__button-close"></div>').appendTo(this.$modal))},showSpinner:function(){this.settings.showSpinner&&(this.spinner=this.spinner||a('<div class="'+this.settings.modalClass+'__spinner"></div>').append(this.settings.spinnerHTML),a("body").append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&(this.spinner.hide(),this.spinner.remove())},center:function(){this.$modal.css({position:"fixed",top:"50%",left:"50%",marginTop:.5*-this.$modal.outerHeight(),marginLeft:.5*-this.$modal.outerWidth(),zIndex:this.settings.zIndex})},bindCloseEvents:function(){this.closeButton&&this.closeButton.on("click."+this._name,null,this,this.close),this.settings.closeOnESC&&a(b).on("keydown."+this._name,null,this,this.handleKeyDown),this.settings.closeOnClickOutside&&a(b).on("mouseup."+this._name,null,this,this.handleBodyClick)},unbindCloseEvents:function(){a(b).off("keydown."+this._name+" mouseup."+this._name)},handleKeyDown:function(a){var b=a.data;27===a.which&&b.close(a)},handleBodyClick:function(a){var b=a.data;b.$modal.is(a.target)||0!==b.$modal.has(a.target).length||b.close(a)},addEventListeners:function(){this.element.on("click."+this._name,null,this,this.open)},destroy:function(){this.unbindCloseEvents(),this.element.off("click."+this._name),this.element.removeData("plugin_"+d)}},a.fn[d]=function(b){return this.each(function(){a.data(this,"plugin_"+d)||a.data(this,"plugin_"+d,new c(this,b))})}}(jQuery,document);